stages:
  - build

build:
  stage: build
  script:
    - mvn clean package
    - cp -f target/tailbaseSampling-1.0-SNAPSHOT.jar dockerfile/tailbaseSampling-1.0-SNAPSHOT.jar
    - docker build -t registry.tbocii.tk:8000/ody123/java-tail-based-sampling dockerfile/
    - docker push registry.tbocii.tk:8000/ody123/java-tail-based-sampling
  only:
    refs:
      - ode
    changes:
      - .gitlab-ci.yml
      - dockerfile/**/*
      - src/**/*
  tags:
    - nscc #108节点